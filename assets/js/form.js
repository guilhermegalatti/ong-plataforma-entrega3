import { validateForm, attachMasks } from './validation.js';import { Store } from './store.js';import { showToast } from './components/Toast.js';
export function bindCadastroForm(root){const form=root.querySelector('#cadastro-form');if(!form)return;attachMasks(form);const submissionsEl=root.querySelector('#submissions');
function renderSubmissions(){const items=Store.submissions();submissionsEl.innerHTML=items.length?items.map(s=>`<article class="card"><h3>${s.name}</h3><p class="text-muted">${s.email} • ${s.city}/${s.state}</p><p class="text-muted">Criado em: ${new Date(s.createdAt).toLocaleString('pt-BR')}</p></article>`).join(''):`<p class="text-muted">Nenhuma inscrição salva ainda.</p>`}renderSubmissions();
form.addEventListener('submit',e=>{e.preventDefault();const {ok,data,errors}=validateForm(form);form.querySelectorAll('.error').forEach(el=>el.classList.remove('error'));if(!ok){errors.forEach(name=>{const input=form.querySelector(`[name="${name}"]`);if(input){input.classList.add('error');input.setAttribute('aria-invalid','true')}});showToast('Verifique os campos destacados.');return;}
Store.addSubmission(data);form.reset();renderSubmissions();showToast('Inscrição salva localmente!');});}